#!/bin/sh
# Copyright (C) YYYY Firstname Lastname; Licenced under GPL v2 or later
#
# configure.sh -- Custom configure script
#
#   Call: CYGWIN-PATCHES/configure.sh <absolute-install-dir>
#   -- THIS AN EXAMPLE: MODIFY AS NEEDED --

PATH="/sbin:/usr/sbin/:/bin:/usr/bin"
LC_ALL="C"

Bootstrap()
{
    #   In case the package does not include ./configure,
    #   it may be auto-generated by 'buildconf' 'autogen'
    #   ... whatever. See the package's documentation.
    #
    #   You can know if you need to use it in case there are
    #   *.in files at top level directory.

    if [ ! -f ./configure ]; then
        if [ -f ./autogen.sh ]; then
            ./autogen.sh
        elif [ -f ./buildconf.sh ]; then
            ./buildconf.sh
        elif [ -f ./configure.in ]; then
            autoconf
            # automake --add-missing
        fi
    fi
}

ConfigurePerl()
{
    # EXAMPLE: perl package configuration

    log="config.log"

    rm -f
    set -x  # Show configuration to user

    perl Makefile.PL                \
      FASTREADER=0                  \
      INSTALLDIRS=perl              \
      PREFIX=$instdir/usr           \
    2>&1 | tee $log

    if grep 'Permission denied' $log; then
        exit 1
    fi
}

Configure()
{
    instdir="$1"
    instdir=${instdir%/}  # Remove trailing slash

    if  [ -z  "$instdir" ] || [ ! -d $instdir ]; then
        echo "$0: [ERROR] No such dir [$instdir]" >&2
        exit 1
    else
        #   EXAMPLE: Any custom configuration options

        ./configure                       \
        --prefix=/usr                     \
        --sysconfdir=/etc                 \
        --libexecdir='${sbindir}'         \
        --exec-prefix=/usr                \
        --localstatedir=/var              \
        --datadir='${prefix}/share'       \
        --mandir='${prefix}/share/man'    \
        --infodir='${prefix}/share/info'  \
        --libdir='${prefix}/lib'          \
        --includedir='${prefix}/include'

    fi
}

# Uncomment to activate the one that you need

# ConfigurePerl "$@"
# Bootstrap && Configure "$@"

# End of file
